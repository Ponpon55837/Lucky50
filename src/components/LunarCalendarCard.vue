<style scoped>
/* å…¨å±€å‹•ç•« */
@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes pulse {
  0%,
  100% {
    opacity: 1;
  }
  50% {
    opacity: 0.7;
  }
}

@keyframes shimmer {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

.animate-spin {
  animation: spin 1s linear infinite;
}

/* ä¸»å®¹å™¨æ¨£å¼ */
.card {
  animation: fadeInUp 0.6s ease-out;
}

/* è¾²æ°‘æ›†å°ˆç”¨å¡ç‰‡æ¨£å¼ */
.lunar-card {
  background: var(--card-bg);
  border: 1px solid var(--border-light);
  padding: 1.25rem;
  border-radius: 1rem;
  backdrop-filter: blur(12px);
  box-shadow:
    0 4px 16px var(--shadow-light),
    0 1px 4px rgba(0, 0, 0, 0.02);
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.lunar-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--accent-text), transparent);
  transition: left 0.6s ease;
}

.lunar-card:hover {
  box-shadow:
    0 12px 40px var(--shadow-medium),
    0 4px 12px rgba(0, 0, 0, 0.1);
  transform: translateY(-2px) scale(1.02);
  border-color: var(--accent-text);
}

.lunar-card:hover::before {
  left: 100%;
}

/* ç¾ä»£åŒ–ç¯€æ—¥æ¨™ç±¤ */
.festival-tag {
  display: inline-flex;
  align-items: center;
  padding: 0.375rem 0.75rem;
  border-radius: 2rem;
  font-size: 0.875rem;
  font-weight: 600;
  letter-spacing: 0.025em;
  border: 1px solid;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.festival-tag::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  transition: left 0.6s ease;
}

.festival-tag:hover::before {
  left: 100%;
}

.festival-tag-green {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.15), rgba(34, 197, 94, 0.05));
  color: #047857;
  border-color: rgba(34, 197, 94, 0.4);
  box-shadow: 0 2px 8px rgba(34, 197, 94, 0.2);
}

.festival-tag-green:hover {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.25), rgba(34, 197, 94, 0.1));
  transform: translateY(-1px);
  box-shadow: 0 4px 16px rgba(34, 197, 94, 0.3);
}

:root.light .festival-tag-green {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(34, 197, 94, 0.02));
  color: #065f46;
  border-color: rgba(34, 197, 94, 0.3);
}

.festival-tag-red {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.15), rgba(239, 68, 68, 0.05));
  color: #b91c1c;
  border-color: rgba(239, 68, 68, 0.4);
  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.2);
}

.festival-tag-red:hover {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.25), rgba(239, 68, 68, 0.1));
  transform: translateY(-1px);
  box-shadow: 0 4px 16px rgba(239, 68, 68, 0.3);
}

:root.light .festival-tag-red {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(239, 68, 68, 0.02));
  color: #991b1b;
  border-color: rgba(239, 68, 68, 0.3);
}

/* ç¾ä»£åŒ–å®œå¿Œæ¨™ç±¤ */
.yi-tag {
  padding: 0.375rem 0.75rem;
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.15), rgba(34, 197, 94, 0.08));
  color: #047857;
  border-radius: 2rem;
  font-size: 0.75rem;
  border: 1px solid rgba(34, 197, 94, 0.4);
  font-weight: 600;
  letter-spacing: 0.025em;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  display: inline-flex;
  align-items: center;
  box-shadow: 0 2px 8px rgba(34, 197, 94, 0.15);
}

.yi-tag::before {
  content: 'âœ“';
  margin-right: 0.25rem;
  font-weight: bold;
}

.yi-tag:hover {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.25), rgba(34, 197, 94, 0.12));
  transform: translateY(-1px) scale(1.05);
  box-shadow: 0 4px 16px rgba(34, 197, 94, 0.25);
}

:root.light .yi-tag {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.12), rgba(34, 197, 94, 0.05));
  color: #065f46;
  border-color: rgba(34, 197, 94, 0.3);
}

.ji-tag {
  padding: 0.375rem 0.75rem;
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.15), rgba(239, 68, 68, 0.08));
  color: #b91c1c;
  border-radius: 2rem;
  font-size: 0.75rem;
  border: 1px solid rgba(239, 68, 68, 0.4);
  font-weight: 600;
  letter-spacing: 0.025em;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  display: inline-flex;
  align-items: center;
  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.15);
}

.ji-tag::before {
  content: 'âœ—';
  margin-right: 0.25rem;
  font-weight: bold;
}

.ji-tag:hover {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.25), rgba(239, 68, 68, 0.12));
  transform: translateY(-1px) scale(1.05);
  box-shadow: 0 4px 16px rgba(239, 68, 68, 0.25);
}

:root.light .ji-tag {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.12), rgba(239, 68, 68, 0.05));
  color: #991b1b;
  border-color: rgba(239, 68, 68, 0.3);
}

/* æ™‚è¾°åˆ†ææ¨£å¼å„ªåŒ– */
.hour-card {
  padding: 0.75rem;
  border-radius: 0.75rem;
  text-align: center;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  border: 1px solid;
  position: relative;
  overflow: hidden;
  backdrop-filter: blur(8px);
  cursor: pointer;
}

.hour-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 2px;
  transition: left 0.6s ease;
}

.hour-card:hover::before {
  left: 100%;
}

/* å¤§å‰æ™‚è¾°æ¨£å¼ */
.hour-daji {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.2), rgba(34, 197, 94, 0.1));
  border-color: rgba(34, 197, 94, 0.5);
  color: #047857;
  box-shadow:
    0 4px 16px rgba(34, 197, 94, 0.2),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.hour-daji::before {
  background: linear-gradient(90deg, transparent, rgba(34, 197, 94, 0.8), transparent);
}

.hour-daji:hover {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.3), rgba(34, 197, 94, 0.15));
  transform: translateY(-2px) scale(1.05);
  box-shadow:
    0 8px 24px rgba(34, 197, 94, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.15);
}

/* å‰æ™‚è¾°æ¨£å¼ */
.hour-ji {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.15), rgba(34, 197, 94, 0.05));
  border-color: rgba(34, 197, 94, 0.4);
  color: #059669;
  box-shadow:
    0 2px 12px rgba(34, 197, 94, 0.15),
    inset 0 1px 0 rgba(255, 255, 255, 0.08);
}

.hour-ji::before {
  background: linear-gradient(90deg, transparent, rgba(34, 197, 94, 0.6), transparent);
}

.hour-ji:hover {
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.25), rgba(34, 197, 94, 0.1));
  transform: translateY(-1px) scale(1.02);
  box-shadow:
    0 6px 20px rgba(34, 197, 94, 0.2),
    inset 0 1px 0 rgba(255, 255, 255, 0.12);
}

/* å¿Œæ™‚è¾°æ¨£å¼ */
.hour-ji-bad {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.1));
  border-color: rgba(239, 68, 68, 0.5);
  color: #b91c1c;
  box-shadow:
    0 4px 16px rgba(239, 68, 68, 0.2),
    inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.hour-ji-bad::before {
  background: linear-gradient(90deg, transparent, rgba(239, 68, 68, 0.8), transparent);
}

.hour-ji-bad:hover {
  background: linear-gradient(135deg, rgba(239, 68, 68, 0.3), rgba(239, 68, 68, 0.15));
  transform: translateY(-2px) scale(1.05);
  box-shadow:
    0 8px 24px rgba(239, 68, 68, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.15);
}

/* æ™®é€šæ™‚è¾°æ¨£å¼ */
.hour-normal {
  background: var(--surface-bg);
  color: var(--secondary-text);
  border-color: var(--border-light);
  box-shadow:
    0 2px 8px var(--shadow-light),
    inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

.hour-normal::before {
  background: linear-gradient(90deg, transparent, var(--border-light), transparent);
}

.hour-normal:hover {
  background: var(--card-bg);
  transform: translateY(-1px);
  box-shadow:
    0 4px 16px var(--shadow-medium),
    inset 0 1px 0 rgba(255, 255, 255, 0.08);
}

/* è¼‰å…¥å‹•ç•«å„ªåŒ– */
.loading-spinner {
  width: 2.5rem;
  height: 2.5rem;
  border: 4px solid var(--border-light);
  border-top-color: var(--accent-text);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 1rem;
  position: relative;
}

.loading-spinner::after {
  content: '';
  position: absolute;
  inset: 4px;
  border: 2px solid transparent;
  border-top-color: rgba(var(--accent-rgb), 0.3);
  border-radius: 50%;
  animation: spin 1.5s linear infinite reverse;
}

/* éŸ¿æ‡‰å¼å„ªåŒ– */
@media (max-width: 768px) {
  .lunar-card {
    padding: 1rem;
    border-radius: 0.75rem;
  }

  .festival-tag,
  .yi-tag,
  .ji-tag {
    font-size: 0.75rem;
    padding: 0.25rem 0.5rem;
  }

  .hour-card {
    padding: 0.5rem;
    font-size: 0.75rem;
  }
}

/* æ·±è‰²æ¨¡å¼å„ªåŒ– */
:root.dark .lunar-card {
  box-shadow:
    0 4px 20px rgba(0, 0, 0, 0.3),
    0 1px 4px rgba(0, 0, 0, 0.2),
    inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

:root.dark .lunar-card:hover {
  box-shadow:
    0 12px 48px rgba(0, 0, 0, 0.4),
    0 4px 16px rgba(0, 0, 0, 0.3),
    inset 0 1px 0 rgba(255, 255, 255, 0.08);
}

/* æ¼¸è®Šå‹•ç•« */
@keyframes gradientShift {
  0%,
  100% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
}

.animated-bg {
  background-size: 200% 200%;
  animation: gradientShift 3s ease infinite;
}

/* è¼”åŠ©é¡ */
.glass-effect {
  backdrop-filter: blur(16px) saturate(180%);
  background-color: rgba(var(--card-bg-rgb), 0.8);
  border: 1px solid rgba(255, 255, 255, 0.125);
}

.shadow-glow {
  filter: drop-shadow(0 0 8px rgba(var(--accent-rgb), 0.3));
}
</style>

<script setup lang="ts">
import { computed } from 'vue'
import { useDashboardStore } from '@/stores/dashboard'
import { useUserStore } from '@/stores/user'

// ä½¿ç”¨å…¨åŸŸç‹€æ…‹ç®¡ç† - ç´”ç²¹æ¶ˆè²»è³‡æ–™ï¼Œä¸é‡è¤‡è¼‰å…¥
const dashboardStore = useDashboardStore()
const userStore = useUserStore()

// è¨ˆç®—å±¬æ€§ - ç›´æ¥ä½¿ç”¨dashboard storeä¸­çš„è³‡æ–™
const lunarInfo = computed(() => dashboardStore.lunarData)
const loading = computed(() => dashboardStore.lunarLoading)

// å‹•æ…‹æ™‚è¾°åˆ†æï¼ŒåŸºæ–¼è¾²æ°‘æ›†è³‡æ–™å’Œç”¨æˆ¶ç”Ÿè‚–
const hourAnalysis = computed(() => {
  // åŸºæœ¬æ™‚è¾°è³‡æ–™
  const hours = [
    { name: 'å­æ™‚', time: '23:00-01:00', zhi: 'å­' },
    { name: 'ä¸‘æ™‚', time: '01:00-03:00', zhi: 'ä¸‘' },
    { name: 'å¯…æ™‚', time: '03:00-05:00', zhi: 'å¯…' },
    { name: 'å¯æ™‚', time: '05:00-07:00', zhi: 'å¯' },
    { name: 'è¾°æ™‚', time: '07:00-09:00', zhi: 'è¾°' },
    { name: 'å·³æ™‚', time: '09:00-11:00', zhi: 'å·³' },
    { name: 'åˆæ™‚', time: '11:00-13:00', zhi: 'åˆ' },
    { name: 'æœªæ™‚', time: '13:00-15:00', zhi: 'æœª' },
    { name: 'ç”³æ™‚', time: '15:00-17:00', zhi: 'ç”³' },
    { name: 'é…‰æ™‚', time: '17:00-19:00', zhi: 'é…‰' },
    { name: 'æˆŒæ™‚', time: '19:00-21:00', zhi: 'æˆŒ' },
    { name: 'äº¥æ™‚', time: '21:00-23:00', zhi: 'äº¥' },
  ]

  // å¦‚æœæ²’æœ‰è¾²æ°‘æ›†è³‡æ–™ï¼Œè¿”å›ä¸­æ€§æ™‚è¾°
  if (!lunarInfo.value) {
    return hours.map(hour => ({
      ...hour,
      isLucky: false,
      status: 'å¾…è¼‰å…¥',
    }))
  }

  // æ ¹æ“šè¾²æ°‘æ›†çš„æ—¥å¤©å¹²æ¨ç®—å‰æ™‚
  const dayGan = lunarInfo.value.dayGanZhi?.charAt(0) // å–å¤©å¹²
  const luckyZhi = getLuckyZhiByGan(dayGan)

  // å„ªå…ˆä½¿ç”¨ç”¨æˆ¶å€‹äººç”Ÿè‚–ï¼Œå¦å‰‡ä½¿ç”¨ç•¶å¹´ç”Ÿè‚–
  const userZodiac = userStore.profile?.zodiac || lunarInfo.value.zodiac

  return hours.map(hour => {
    let isLucky = false
    let status = 'å¹³'

    // åŸºæ–¼å¤©å¹²çš„å‰æ™‚åˆ¤æ–·
    if (luckyZhi.includes(hour.zhi)) {
      isLucky = true
      status = 'å‰'
    }

    // åŸºæ–¼ç”¨æˆ¶ç”Ÿè‚–çš„é€²ä¸€æ­¥èª¿æ•´
    if (userZodiac) {
      const zodiacLuckyZhi = getZodiacLuckyZhi(userZodiac)
      if (zodiacLuckyZhi.includes(hour.zhi)) {
        isLucky = true
        status = 'å¤§å‰'
      }

      // æª¢æŸ¥æ˜¯å¦ç‚ºæ²–æ™‚
      const clashZhi = getClashZhi(userZodiac)
      if (clashZhi.includes(hour.zhi)) {
        isLucky = false
        status = 'å¿Œ'
      }
    }

    return {
      ...hour,
      isLucky,
      status,
    }
  })
})

// ç”¨æ–¼é¡¯ç¤ºåˆ†æåŸºæº–çš„è¨ˆç®—å±¬æ€§
const analysisBase = computed(() => {
  if (!lunarInfo.value) return { dayGanZhi: 'è¼‰å…¥ä¸­...', zodiac: 'è¼‰å…¥ä¸­...' }

  const userZodiac = userStore.profile?.zodiac || lunarInfo.value.zodiac
  const zodiacSource = userStore.profile?.zodiac ? '(å€‹äººç”Ÿè‚–)' : '(ç•¶å¹´ç”Ÿè‚–)'

  return {
    dayGanZhi: lunarInfo.value.dayGanZhi,
    zodiac: `${userZodiac} ${zodiacSource}`,
  }
})

// æ ¹æ“šå¤©å¹²ç²å–å°æ‡‰çš„å‰æ™‚åœ°æ”¯
function getLuckyZhiByGan(gan: string): string[] {
  const ganToZhi: Record<string, string[]> = {
    ç”²: ['å­', 'è¾°', 'ç”³'], // ç”²æ—¥è²´äººåœ¨å­è¾°ç”³
    ä¹™: ['ä¸‘', 'å·³', 'é…‰'], // ä¹™æ—¥è²´äººåœ¨ä¸‘å·³é…‰
    ä¸™: ['å¯…', 'åˆ', 'æˆŒ'], // ä¸™æ—¥è²´äººåœ¨å¯…åˆæˆŒ
    ä¸: ['å¯', 'æœª', 'äº¥'], // ä¸æ—¥è²´äººåœ¨å¯æœªäº¥
    æˆŠ: ['è¾°', 'ç”³', 'å­'], // æˆŠæ—¥è²´äººåœ¨è¾°ç”³å­
    å·±: ['å·³', 'é…‰', 'ä¸‘'], // å·±æ—¥è²´äººåœ¨å·³é…‰ä¸‘
    åºš: ['åˆ', 'æˆŒ', 'å¯…'], // åºšæ—¥è²´äººåœ¨åˆæˆŒå¯…
    è¾›: ['æœª', 'äº¥', 'å¯'], // è¾›æ—¥è²´äººåœ¨æœªäº¥å¯
    å£¬: ['ç”³', 'å­', 'è¾°'], // å£¬æ—¥è²´äººåœ¨ç”³å­è¾°
    ç™¸: ['é…‰', 'ä¸‘', 'å·³'], // ç™¸æ—¥è²´äººåœ¨é…‰ä¸‘å·³
  }

  return ganToZhi[gan] || ['è¾°', 'åˆ'] // é è¨­å‰æ™‚
}

// æ ¹æ“šç”Ÿè‚–ç²å–å°æ‡‰çš„ä¸‰åˆå‰æ™‚
function getZodiacLuckyZhi(zodiac: string): string[] {
  const zodiacToZhi: Record<string, string[]> = {
    é¼ : ['å­', 'è¾°', 'ç”³'], // ç”³å­è¾°ä¸‰åˆ
    ç‰›: ['ä¸‘', 'å·³', 'é…‰'], // å·³é…‰ä¸‘ä¸‰åˆ
    è™: ['å¯…', 'åˆ', 'æˆŒ'], // å¯…åˆæˆŒä¸‰åˆ
    å…”: ['å¯', 'æœª', 'äº¥'], // äº¥å¯æœªä¸‰åˆ
    é¾: ['è¾°', 'å­', 'ç”³'], // ç”³å­è¾°ä¸‰åˆ
    è›‡: ['å·³', 'é…‰', 'ä¸‘'], // å·³é…‰ä¸‘ä¸‰åˆ
    é¦¬: ['åˆ', 'å¯…', 'æˆŒ'], // å¯…åˆæˆŒä¸‰åˆ
    ç¾Š: ['æœª', 'äº¥', 'å¯'], // äº¥å¯æœªä¸‰åˆ
    çŒ´: ['ç”³', 'å­', 'è¾°'], // ç”³å­è¾°ä¸‰åˆ
    é›: ['é…‰', 'ä¸‘', 'å·³'], // å·³é…‰ä¸‘ä¸‰åˆ
    ç‹—: ['æˆŒ', 'å¯…', 'åˆ'], // å¯…åˆæˆŒä¸‰åˆ
    è±¬: ['äº¥', 'å¯', 'æœª'], // äº¥å¯æœªä¸‰åˆ
  }

  return zodiacToZhi[zodiac] || []
}

// æ ¹æ“šç”Ÿè‚–ç²å–ç›¸æ²–çš„æ™‚è¾°ï¼ˆéœ€è¦é¿å…çš„æ™‚è¾°ï¼‰
function getClashZhi(zodiac: string): string[] {
  const zodiacClash: Record<string, string[]> = {
    é¼ : ['åˆ'], // å­åˆç›¸æ²–
    ç‰›: ['æœª'], // ä¸‘æœªç›¸æ²–
    è™: ['ç”³'], // å¯…ç”³ç›¸æ²–
    å…”: ['é…‰'], // å¯é…‰ç›¸æ²–
    é¾: ['æˆŒ'], // è¾°æˆŒç›¸æ²–
    è›‡: ['äº¥'], // å·³äº¥ç›¸æ²–
    é¦¬: ['å­'], // åˆå­ç›¸æ²–
    ç¾Š: ['ä¸‘'], // æœªä¸‘ç›¸æ²–
    çŒ´: ['å¯…'], // ç”³å¯…ç›¸æ²–
    é›: ['å¯'], // é…‰å¯ç›¸æ²–
    ç‹—: ['è¾°'], // æˆŒè¾°ç›¸æ²–
    è±¬: ['å·³'], // äº¥å·³ç›¸æ²–
  }

  return zodiacClash[zodiac] || []
}
</script>
<template>
  <div class="card">
    <div class="flex items-center justify-between mb-4">
      <h3 class="text-lg font-bold flex items-center" style="color: var(--primary-text)">
        <span class="mr-2" style="color: var(--accent-text)">ğŸ“†</span>
        ä»Šæ—¥è¾²æ°‘æ›†
      </h3>
      <div class="text-sm" style="color: var(--secondary-text)">
        {{ dashboardStore.formattedCurrentDate }}
      </div>
    </div>

    <div v-if="lunarInfo && !loading" class="space-y-4">
      <!-- è¾²æ›†æ—¥æœŸ -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="lunar-card">
          <h4 class="font-semibold text-red-500 mb-2">è¾²æ›†æ—¥æœŸ</h4>
          <div class="text-lg font-bold" style="color: var(--primary-text)">
            {{ lunarInfo.lunarYear }}å¹´ {{ lunarInfo.lunarMonth }}æœˆ {{ lunarInfo.lunarDay }}æ—¥
          </div>
          <div class="text-sm mt-1" style="color: var(--secondary-text)">
            {{ lunarInfo.ganZhi }}å¹´ {{ lunarInfo.monthGanZhi }}æœˆ {{ lunarInfo.dayGanZhi }}æ—¥
          </div>
        </div>

        <div class="lunar-card">
          <h4 class="font-semibold text-blue-500 mb-2">ç”Ÿè‚–æ˜Ÿåº§</h4>
          <div class="text-lg font-bold" style="color: var(--primary-text)">
            {{ lunarInfo.zodiac }}å¹´ {{ lunarInfo.constellation }}
          </div>
          <div class="text-sm mt-1" style="color: var(--secondary-text)">
            æœ¬å‘½ç´éŸ³ï¼š{{ lunarInfo.naYin }}
          </div>
        </div>
      </div>

      <!-- ç¯€æ°£ç¯€æ—¥ -->
      <div v-if="lunarInfo.jieQi" class="lunar-card">
        <h4 class="font-semibold mb-2" style="color: var(--accent-text)">ç¯€æ°£ç¯€æ—¥</h4>
        <div class="flex flex-wrap gap-2">
          <span v-if="lunarInfo.jieQi" class="festival-tag festival-tag-green">
            {{ lunarInfo.jieQi }}
          </span>
        </div>
      </div>

      <!-- å®œå¿Œäº‹é … -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
        <div class="lunar-card">
          <h4 class="font-semibold text-green-500 mb-2">å®œ</h4>
          <div class="flex flex-wrap gap-1">
            <span v-for="item in lunarInfo.yi" :key="item" class="yi-tag">
              {{ item }}
            </span>
          </div>
        </div>

        <div class="lunar-card">
          <h4 class="font-semibold text-red-500 mb-2">å¿Œ</h4>
          <div class="flex flex-wrap gap-1">
            <span v-for="item in lunarInfo.ji" :key="item" class="ji-tag">
              {{ item }}
            </span>
          </div>
        </div>
      </div>

      <!-- æ™‚è¾°åˆ†æ -->
      <div class="lunar-card">
        <h4 class="font-semibold mb-3 flex items-center" style="color: var(--primary-text)">
          <span class="mr-2" style="color: var(--accent-text)">ğŸ•</span>
          ä»Šæ—¥æ™‚è¾°å‰å‡¶åˆ†æ
        </h4>
        <div class="text-xs mb-3" style="color: var(--secondary-text)">
          åŸºæ–¼è¾²æ°‘æ›† {{ analysisBase.dayGanZhi }} æ—¥å’Œç”Ÿè‚– {{ analysisBase.zodiac }} æ¨ç®—
        </div>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-xs">
          <div
            v-for="hour in hourAnalysis"
            :key="hour.time"
            :class="[
              'hour-card',
              {
                'hour-daji': hour.status === 'å¤§å‰',
                'hour-ji': hour.status === 'å‰',
                'hour-ji-bad': hour.status === 'å¿Œ',
                'hour-normal': hour.status === 'å¹³' || hour.status === 'å¾…è¼‰å…¥',
              },
            ]"
          >
            <div class="font-bold text-sm mb-1">{{ hour.name }}</div>
            <div class="text-xs opacity-75 mb-2">{{ hour.time }}</div>
            <div class="text-sm font-bold flex items-center justify-center">
              <span v-if="hour.status === 'å¤§å‰'" class="mr-1">â­</span>
              <span v-else-if="hour.status === 'å‰'" class="mr-1">âœ¨</span>
              <span v-else-if="hour.status === 'å¿Œ'" class="mr-1">âš ï¸</span>
              <span v-else-if="hour.status === 'å¹³'" class="mr-1">â—</span>
              {{ hour.status }}
            </div>
          </div>
        </div>
        <div class="mt-3 text-xs" style="color: var(--secondary-text)">
          <span class="text-green-600">å¤§å‰â­</span>ï¼šç”Ÿè‚–ä¸‰åˆå‰æ™‚ |
          <span class="text-green-500">å‰âœ¨</span>ï¼šå¤©å¹²è²´äººå‰æ™‚ |
          <span class="text-gray-500">å¹³</span>ï¼šæ™®é€šæ™‚è¾° |
          <span class="text-red-500">å¿Œâš ï¸</span>ï¼šç”Ÿè‚–ç›¸æ²–æ™‚è¾°
        </div>
      </div>
    </div>

    <div v-else class="text-center py-8" style="color: var(--secondary-text)">
      <div v-if="loading" class="loading-spinner"></div>
      <div v-else class="text-red-500">
        <span class="text-2xl">âš ï¸</span><br />
        è¼‰å…¥è¾²æ°‘æ›†è³‡æ–™å¤±æ•—
      </div>
      {{ loading ? 'è¼‰å…¥è¾²æ°‘æ›†è³‡æ–™ä¸­...' : 'è«‹é‡æ–°æ•´ç†é é¢' }}
    </div>
  </div>
</template>
